# CV_3w_1_영상 처리의 세가지 기본연산

```
2.4.1 점 연산 : 오직 자신의 명암값에 따라 새로운 값을 결정
2.4.2 영역 연산 : 이웃 화소의 명암값에 따라 새로운 값 결정
2.4.3 기하 연산 : 일정한 기하 연산으로 결정된 화소의 명암값에 따라 새로운 값 결정
```

## 점 연산

- *이미지의 각 픽셀에 동일한 연산을 적용하는 연산이다.*
- `영상 출력(x, y) = f(영상 입력(x, y))`

![image](https://github.com/hhzzzk/studyLog/assets/67236054/88192ced-7416-4a11-b8e1-cc92a4919e2f)

- 각 픽셀을 독립적으로 처리한다

![image](https://github.com/hhzzzk/studyLog/assets/67236054/37313c06-765e-4384-a8ab-82e086819878)

- L-1은 최대 밝기

  밝게는 a 만큼 밝게 하고 어둡게는 0보다 아래로는 내려가지 않게 a만큼 어둡게 한다.

  ​

  ###💜비선형 연산💜

  비선형 연산은 픽셀 사이의 관계를 선형적으로 처리하지 않고는 연산이다.

  선형 연산은 입력 픽셀 값에 상수를 곱하거나 더하는 선형 관계를 갖지만 비선형 연산은 그렇지 않다.

   -  주로 영상의 특정 부분을 강조하거나 필터링할 때 사용

   -  ?saturation 채도?

      ###💜감마수정💜

      모니터나 프린터의 색상 조절에 사용한다. 

      ​	`주로 이미지의 어두운 부분 또는 밝은 부분을 강조하는 데 사용`

      감마값에 따라 변환 함수의 모양은 입력 밝기와 출력 밝기 사이의 비선형 관계를 결정한다.

      - 감마값이 1보다 크면 어두운 부분을 강조하고

         1보다 작으면 밝은 부분을 강조한다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/64725c9a-bc3b-45a3-8043-987ea5883543)

	### 	💜디졸브💜

​		K=2 (2개의 이미지/영상?를 이용한다.)

​		두 개의 이미지를 혼합해 새로운 이미지를 생성한다. 

​		주로 두 이미지간의 전환 효과를 만들거나 부드럽게 전환할 때 사용한다.

​		대표적으로 페이드인 페이드아웃이 있다.

​		A화면에서 B화면으로 화면을 전환할 때 알파값(0-1)을 서서히 조정해 자연스럽게 화면전환한다.

​		식은 f1화면에서 f2화면으로 전환

![image](https://github.com/hhzzzk/studyLog/assets/67236054/076d9bbc-30eb-4924-a17f-6c9dfae65387)




## 영역 연산(필터링)

- 이미지의 *여러 픽셀*을 대상으로 한번에 연산을 수행하는 방법이다.

- spatial domain 공간 영역에서 이미지에 수학적 연산을 수행한다. 영상 필터는 숫자 그리드(3*3등)로 표현된다.

  - Smoothing, sharpening, measuring texture 등에 이용된다.

- 각 위치에서 *주변 이웃 픽셀을 계산에 이용*한다.

  ###💖역할💖

  1. 필터링을 통해 이미지의 노이즈를 제거하거나 이미지 크기를 조정하거나 대비를 뚜렷하게 한다.

  (Denoise, resize, increase contrast, etc.)

  2, 이미지로부터 질감, 에지, 독특한 점 등의 정보를 추출하는데 사용된다. 

  ​	이를 통해 이미지의 중요 패턴이나 특징을 검출할 수 있다.

  3. 이미지에서 특정한 패턴이나 템플릿을 검출하는데 활용된다. (Template Matching)

  ### ❤️상관 correlation❤️

  두 이미지의 유사성을 측정하거나 패턴 검출에 활용된다.

  #### 	1차원에서의 예시

  ​	![image](https://github.com/hhzzzk/studyLog/assets/67236054/19d75fb2-0259-40dd-bdb2-0920892ca19f)

  윈도우가 일종의 필터 역할을 한다. 

  윈도우의 가운데를 입력 영상의 한 픽셀에 맞추고 이웃 픽셀의 값들도 반영해서 더해서 

  ​	출력영상의 픽셀값이 결정된다.

  ### ❤️컨볼루션 convolution❤️

  컨볼루션은 윈도우를 뒤집은 후 상관을 적용한 것이다.

  2차원 상관 연산

  - 입력 영상의 값이 0이어도 주변의 값에 따라 픽셀이 바뀔 수 있음
  - 윈도우의 중앙에 맞추고 연산 후 해당 결과를 한 픽셀에 적용 하는 방법은 동일 함

![img](https://velog.velcdn.com/images/3eung_h10n/post/da882fca-3ab9-461d-b4f7-efeb9ab5654b/image.png)

​	

​		❤️**상관, 컨볼루션의 차이**❤️

- 상관은 연산 후 결과값이 윈도우와 반대로 나옴
- 윈도우의 특성을 그대로 적용 시키기 위해 윈도우를 뒤집은 후 연산하는 컨볼루션을 더 많이 사용함
  - 이 때 뒤집는다는 수평, 수직으로 뒤집음. x축 y축을 기준으로 두 번 반전. y=x축 기준으로 반전

![image](https://github.com/hhzzzk/studyLog/assets/67236054/7804aec3-6c9d-4ab4-9235-b29d76fbbf58)

- 컨볼루션은 별표로 표시한다.

  ​	컨볼루션은 마이너스



## Continuous Convolution

사실 컨볼루션은 전자공학에서 시작된 개념이다. 

결론만 말하면 discrete convolution. 미분 가능하지 않은 함수를 미분 가능하게 만드는 의미가 있다.

컴퓨터 비전에서 이를 통해 특징 강조하는데 컨볼루션을 사용한다.

###⭐Convolutional Neural Network (CNN)⭐

- 주로 이미지 분류, 객체 감지, 얼굴 인식, 자연어 처리 등 다양한 기계학습 작업에서 사용되는 딥러닝 네트워크 아키텍처이다.

- 컨볼루션 레이어와 풀링 레이어로 구성된다.

- 컨볼루션 레이어에서 필터를 이동시킬 때 패딩과 스트라이드 매개변수를 이용한다.

  - 패딩은 입력 이미지 주변에 추가적인 가상의 픽셀을 추가한다. 이를 통해 출력 크기를 입력 크기와 동일하게 유지하거나 줄일 수 있다.

  - 스트라이드는 필터를 입력 이미지 상에서 몇 칸씩 이동시킬지 그 간격을 말한다.

    ​	local feature를 찾는 것인데 1개의 픽셀에 대해 주변값들을 가지고 특징을 찾는 것이다.

    ​	계층구조이다.



## 컨볼루션 예제

- 박스 필터 : 주변 픽셀들의 평균값으로 바꾸는 역할 -> 주변과의 경계를 줄여줌 (스무딩)
- 샤프닝 필터 : 내가 가지고 있는 픽셀은 강조, 주변은 감소 -> 주변과 내 자신의 경계를 뚜렷하게 함
- 수평 엣지 : 세로 방향의 변화를 강조
- 수직 헷지 : 가로 방향의 변화를 강조

![img](https://velog.velcdn.com/images/3eung_h10n/post/f37151aa-2bf1-4f1f-a29d-f5acd81a47fc/image.png)





### 	💜박스 필터 예시💜

- 윈도우의 넓이만큼 나눠 평균을 구해서 적용하는 방식(윈도우가 3*3이면 9로 나누기)

![img](https://velog.velcdn.com/images/3eung_h10n/post/334db55d-8ca5-40da-9e74-7da4a0f4de29/image.png)

- 주변값의 평균으로 필터링된다. 모자이크할 때 박스 필터를 이용한다.
- 스무싱, 이미지를 흐리게 만든다. remove sharp features



## 선형필터

```
000
010
000
```

해당 필터는 아무 효과가 없다.

```
000
001
000
```

해당 필터는 왼쪽으로 1칸 shift된다.

```
000				111
020   -   1/9  	111
000 			111
```

해당 필터는 sharpening 필터 효과이다. 경계를 뚜렷하게 한다.

```
1 0 -1
2 0 -2
1 0 -1
```

해당 필터는 수직 vertical 방향에 대한 sobel 필터이다. 

​	소벨필터는 엣지 검출에 주로 사용된다. 

​	특정 방향에서의 픽셀 간 변화를 감지해 이미지의 경계를 찾는데 효과적이다. 

​	주로 수직, 수평 방향 두 가지가 있다.

```
1 2 1
0 0 0
-1 -2 -1
```

해당 필터는 수평 horizontal edge에 대한 소벨 필터이다.



### 	💜선형 필터 특징💜

선형성이 있다. 교환, 결합 법칙이 성립한다. 순서 상관 없다.

### 	💜가우시안 필터💜

이미지를 흐리게 만들어 잡음을 감소시킨다.

- 박스 필터와 유사하나 박스 필터는 격자 무늬가 나오는데 가우시안 필터는 그렇지 않다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/1e9b6f01-0fe7-43e3-a0e0-c58e8a0d4768)



- high-frequency, 튀는 값?을 제거한다.
- **Separable kernel** - 가우스 커널은 분리 가능한 성질을 가진다. 가로 방향과 세로 방향으로 각각 1차원 가우스 커널을 적용하는 것으로 분해할 수 있다. 이를 이용하면 처리 시간을 절약할 수 있다.



## 영역 연산의 비선형 연산

대표적으로 메디안 필터가 있다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/8e036e9f-ac91-48f3-ba91-2a9431308b42)



- 메디안 필터는 입력 이미지에서 픽셀 값의 중간값을 찾아 출력으로 사용한다. 주로 노이즈 제거에 사용

- 솔트페퍼 잡음에 효과적이다.

  - 솔트페퍼 잡음은 흰색과 검정의 점들로 이뤄지는 노이즈를 말한다.
  - 0 혹은 255의 값을 가지는 노이즈들

- 메디안 필터는 *주변 픽셀의 값들을 정렬한 후 중간값을 선택*하므로 이상치가 노이즈가 있는 픽셀에 큰 영향을 받지 않는다.

  ### 💜비교💜

- 가우시안 필터와 달리 메디안 필터는 엣지를 더 잘 보존한다.

  - 가우시안 필터는 주변 픽셀의 가중치 합을  사용하므로 엣지 부분에서 부드럽게 흐리게 된다.
  - 메디안 필터는 주변 픽셀 값들 중 중간값을 선택하므로 엣지를 보존하면서 노이즈를 줄인다.

- 평균 필터보다도 이상치나 노이즈에 더 강하다.

  ### 💜메디안 피터의 컨볼루션 여부💜

- 메디안 필터는 컨볼루션 필터 중 하나가 아니다.

  - 컨볼루션은 주로 가중치 계수와 입력 이미지 간의 선형 결합을 통해 출력을 계산한다.
  - 반면 메디안 필터는 중간값을 선택하는 비선형 연산이다.

