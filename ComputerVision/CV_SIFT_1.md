# CV_SIFT_1

4장 지역특징 검출

## 스케일에 불변한 특징점 검출

- 거리에 따른 스케일 변화
  - 기존에는 코너처럼 보이지만 영상을 확대하면 엣지나 플랫처럼 보일 수 있다.
  - 이전에 배운 해리스 코너 알고리즘은 회전 불변하나 크기 불변하지 않는 한계가 있었다.


![img](https://blog.kakaocdn.net/dn/ZKuYU/btrn1ZKHCb8/ZdHUG4tfo56GgAm4OKcS8K/img.png)



## Types of invariance

**invaiance** : 특정한 변화나 조건에 대해 불변하는 성질이다. 불변성

![image](https://github.com/hhzzzk/studyLog/assets/67236054/9b559164-6191-49fe-9c39-aa9ee519a381)

해리스 코너 감지 알고리즘이 각 유형에 어떠한가

**Illumination(조명)** : 강한 조명일 경우 코너 감지에 취약하다.

**Scale** : 크기 변화에 매우 민감하다!

**Rotation** : 회전에는 비교적 강인하다.

**Affine** : 아핀 변형은 이미지에서 평행성이 유지되지 않는 변형이다. 이에 민감하다.

> 해리스 코너 디텍션은 이동과 회전에는 강인한 특징을 가지고 있지만 스케일에 대해서 매우 민감한 단점이 있다.

## SIFT

![image](https://github.com/hhzzzk/studyLog/assets/67236054/ca11c557-df52-4013-bbcd-84b32ee7a10e)



시프트의 등장!

스케일의 변화에 강인한 특징을 가진 SIFT 알고리즘이 제안된다.



## SIFT MATCHING

파노라마 영상을 만들기 위해서는 이미지 매칭이 필요하다. 두 개의 영상에서 특징점을 찾아 매칭한다.

🐤**파노라마 이미지 만드는 과정**🐤

1. 두 이미지 간에 공통된 부분을 찾고 해당되는 부분의 특징점들을 찾는다.
   - 이 특징점들을 하나의 기술자 디스크립터로 표현한다. 이는 일반적으로 고차원 벡터로 표현된다.
2. 생성된 고차원 벡터들 간의 유사도를 비교해 두 이미지가 일치하는 부분을 찾는다.
   - corresponding pairs 찾기, affine 또는 perspective 변환에 따라 매칭점의 수가 최소 6개나 8개 필요하다.
3. **영상 align** : 매칭된 점을 기반으로 두 영상의 회전과 이동을 계산한다. 두번째 영상을 첫번째 영상과 일치하도록 조정 가능
4. 영상 병합 : 두 영상을 연결해 파노라마 이미지를 만든다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/8380125e-82b1-49e4-b9a7-c37f9b510729)

## 특징점 매칭하기

문제1 : 각 영상으로부터 똑같은 특징점 찾아야 한다.

​		회전의 이동에, 스케일의 변화에, 조명 환경의 변화에 강인한 특징을 찾아야 된다!

문제2 : 똑같은 특징점들을 비교해 **어떻게**  매칭할 것인가?

​		특징점 주변의 디스크립터를 사용하여 각 특징점의 유사도를 계산



## 스케일 공간

스케일에 강인한! 특징을 찾기 위해서는 다양한 해상도의 영상을 사용할 수 있다.

다양한 해상도의 영상을 사용해 특징이 유지된다면 스케일의 변화에 강인한 특징점을 찾을 수 있다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/ad71ece6-2d72-4d39-a220-2c2435dfeefa)

**다중 스케일 영상을 구현하는 두 가지 방식**

1. 가우시안 스무딩
   - DoG(Difference of Gaussians) 필터는 동일한 축 내에 서로 다른 시그마 값을 사용해 가우시안 필터가 적용된 영상들 가의 차이를 구한다.
   - 시그마 값은 가우시안 필터의 분산을 나타내는 매개변수, 값이 커지면(필터 커지면) 흐릿한 영상이 되고 작아지면 세밀한 영상이 된다.
2. 피라미드
   - width, height를 1/2씩 줄여가면서 해상도를 다르게 한다.

- 주로 가우시안 필터와 피라미드 영상을 동시에 사용해 특징을 검출한다.

## 가우시안 스무딩에 의한 스케일 공간

- 스케일 축을 추가한 3차원 공간

![image](https://github.com/hhzzzk/studyLog/assets/67236054/8b181aea-421e-4907-9445-5a6269ab0590)

- t는 스케일 값이다. 해당 3차원 공간은 가우시안 스무딩에 의해 다양한 스케일에서 이미지를 표현한다.
- t는 가우시안 스무딩에 사용되는 시그마값과 관련 있다.



## SIFT: 알고리즘

시프트 알고리즘은 주어진 영상에서 local min과 local max가 스케일 변화가 있는 축에 따라 일정하게 유지되는 경우에만 특징점으로 간주한다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/9d392117-e103-40cb-98a2-03d996df12a8)

## 스케일 공간 지역 극점 탐색



**t축에서 지역 극점 탐색**

- t축은 스케일을 나타내며 이미지의 다양한 스케일에서 정규 라플라시안을 측정하면 극점이 발생한다.
  - 영상에 가우시안 처리에서 블러 처리, y축으로 2차미분 x축으로 2차미분 등..

![image](https://github.com/hhzzzk/studyLog/assets/67236054/0ee11fae-385f-4e11-beba-4bae8cf171aa)

 - ​


- t축에서 정규 라플라시안은 다양한 스케일에서 안정적으로 극점을 생성한다.
- 극점의 σ 값은 물체의 스케일에 해당한다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/86bbbbe4-f44f-44eb-ac99-c8a10dedba43)



![image](https://github.com/hhzzzk/studyLog/assets/67236054/39403f84-8263-476e-ac17-c8879697b0a5)

최대 edge는 0.9정도, 서로 다른 스케일 값에서 최대값 2개가 검출

정규 라플라시안 y값 자체는 비슷하다.



## SIFT 검출

- SIFT의 스케일 공간
  - 피라미드 + 가우시안 구조로 구성된다.
  - 각 층은 여섯 영상의 묶음(옥타브)으로 구성된다.
  - 옥타브의 각 영상은 시그마 값에 따라 스무딩된다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/f57f560c-7014-4de9-9fc9-08071e66e9c8)



## 정규 라플라시안 맵 구축

실혐 결과에 따르면 정규 라플라시안이 가장 안정적으로 극점을 형성한다고 확인됐다.

​		극점은 주요한 특징을 나타낸다.

그러나 정규 라플라시안을 직접 계산하는 것은 비용이 많이 들기에

정규 라플라시안과 유사한 DoG 계산으로 대체된다.

DoG는 차영상을 계산하는 단순한 연산으로 빠르게 수행이 가능하다.

- 정규 라플라시안은 2차 미분한 것이고 도그는 시그마 값이 하나 큰 필터에서 작은거 뺀다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/99fbfcf9-451d-453c-9c9d-e142367b86b5)



## 특징점(키 포인트) 검출

- 한 옥타브에 다섯 장의 DOG 영상이 있다.
- 중간에 끼인 3장의 DOG 맵에서 극점이 검출됐다.
  - 주위 26개의 이웃에 대해 최저 또는 최대인 점 (9*3에서 가운데 1개 빼서 26개 이웃)
- 검출된 극점을 키포인트라고 한다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/4830b3ef-6dfa-46a0-8be1-416cfe2c3966)

---

![img](https://velog.velcdn.com/images/3eung_h10n/post/255a62e4-a58b-4b38-bcf2-1a0fb3d5f36b/image.png)

