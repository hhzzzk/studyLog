# AI_2_선형대수(2)

13p

4w2

> 규제에 따라 크기는 같지만 서로 다른 양상을 보인다.

## 벡터의 곱셈

- 스칼라 곱셈은 방향은 그대로, 크기를 키운다.
- 백터의 내적은 결과가 스칼라다. 두 벡터의 방향이 얼마나 비슷한지 나타낸다. 내적이 0보다 크면 두 벡터는 비슷한 방향을 가지며 내적이 0이면 두 벡터는 수직이다. 0보다 작으면 두 벡터는 반대 방향을 가진다.
  - 유사성, 투영 등에 사용한다.
- 벡터의 외적은 결과가 벡터다. 두 벡터가 결정하는 평면에 수직인 벡터를 생성한다. 외적 결과 벡터의 크기는 두 벡터가 결정하는 평면의 넓이에 비례하며 방향은 오른족 손 법칙을 따른다.
  - 볼륨, 넓이, 공간의 크기 측정



## 선형 결합

- 벡터의 곱과 덧셈 등의 선형 연산을 통해 새로운 벡터를 얻는 연산이다. **벡터 공간을 형성**한다.
- *span(생성공간)* : 벡터 집합 A는 해당 벡터들의 선형 결합으로 가능한 모든 벡터의 집합이다.



## 선형 독립과 선형 종속

a 벡터에 선형 연산을 해도 b벡터에 도달할 수 없다면 선형 독립이다. 그렇지 않고 어떤 벡터가 다른 벡터의 선형 조합으로 표현될 수 있다면 선형 종속이다.

- PCA : 데이터 차원 축소 및 특성 추출 기술이다. 주로 다차원 데이터의 차원을 줄이거나 데이터의 주요 특성을 추출하는데 사용된다. 데이터를 통계적으로 분석하고 주성분 principal component라고 불리는 새로운 특성을 찾아낸다.
  - 데이터에서 공분산 행렬을 구하고 그를 고유값 분해한다. 고유벡터와 고유값을 얻어낸다.
  - 고유값은 데이터의 분산이고 고유벡터는 데이터의 주요 방향이다. 일반적으로 고유값을 큰 순서, 내림차순으로 정렬하고 가장 큰 고유값에 해당하는 고유벡터가 첫번째 주성분이 된다.
  - *주성분을 사용해 데이터를 투영해 데이터의 차원을 줄이거나 주요 특성을 추출한다.*
  - *선택한 주성분을 사용해 데이터를 새로운 차원으로 투영한다. 데이터의 차원을 줄이고 데이터의 분산을 최대한 보존하는 새로운 특성을 얻을 수 있다.*

## 공간과 기저

### 	🐋축(기저)🐋

2차원 공간은 직교하는 2개의 기저로 이루어진다.

> 기저는 공간을 생성할 때 필요한 최소한의 선형 독립 벡터 집합이다.

기저 : 벡터 공간 내에 모든 벡터를 생성하는데 필요한 최소한의 벡터집합이다. 기저 벡터들의 조건은 다음과 같다.

- 기저 벡터들은 선형 독립이다
- 기저 벡터들의 span은 전체 벡터 공간이다.
- 벡터 공간 내의 모든 벡터는 기저 벡터들의 선형 조합으로 표현  가능하다.

기저는 벡터 공간을 특정 방향으로 늘리거나 회전하는데 사용되며 벡터 공간의 차원과 관련 있다.

> 차원은 기저 벡터의 개수를 의미한다.

### 	🐋랭크🐋

랭크는 선형 독립인 행이나 열의 개수를 의미한다.

*일반적으로 행 랭크와 열 랭크는 동일하다.*

- **행렬의 랭크를 구하는 것은 행렬의 선형 종속성을 파악하고 행렬 방정식 시스템의 해의 존재와 유일성을 결정하는데 사용된다.**
- 랭크를 통해 행렬의 해가 유일한지 판단 가능하다.



## 행렬의 곱셈

행렬 곱셈은 신경망 연산의 기본단위이다.

행렬 곱셈을 통해 데이터를 새로운 공간으로 변환 가능하다. (선형 변환/ 선형 매핑)



## 역행렬

>  역행렬이 존재하면 해당 선형 방정식은 유일해이다.

![image](https://github.com/hhzzzk/studyLog/assets/67236054/b2fa26a8-2b0c-4f7c-a122-2e6b573fa6f8)

역행렬이 존재하려면 A는 정사각행렬이고 가역, 즉 A의 행이나 열 벡터들이 선형독립이다.



## 행렬식

det(A)

ad-bc

- 행렬식은 정사각행렬에 대해서만 정의된다.
- *det(A) = 0이면 역행렬이 존재하지 않는다.*

행렬식의 절대값은 주어진 행렬의 곱에 의한 공간의 확장 또는 축소로 볼 수 있음

> det(A) = 0 : 하나의 차원을 따라 축소되어 공간의 부피를 잃었다.
>
> det(A) = 1 : 공간의 부피를 유지한 변환이다. 면적 보존
>
> det(A) > 1 : 공간의 부피 확대
>
> det(A) < 1 : 공간의 면적 축소

- 차원에서의 기하학적인 예시
  - 2차원에서는 2개의 행 벡터가 이루는 평행사변형의 넓이
  - 3차원에서는 3개의 행벡터가 이루는 평행가가기둥의 부피



## 정부호 행렬

양의 정부호 행렬 : 0이 아닌 모든 벡터 x에 대해 (x^T)Ax > 0

준정부호는 0을 포함한다.

?볼록함수 오목함수이다.

```
정부호 행렬은 대칭 행렬이다. 
양의 정부호 행렬은 목적 함수의 볼록성 convexity와 관련이 있다. 
양의 정부호 행렬은 고유값이 모두 양수이며 역행렬이 존재한다.
```



## 분해

행렬을 분해하자.

### 	🐋고유값과 고유 벡터🐋

>  Av = λv

- **고유 벡터는 선형 변환을 취했을 때 방향은 변하지 않고 크기만 변하는 벡터**이다.
- *변한 크기가 고유값이다.*



### 	🐋2차원 공간에서의 고유 값과 고유 벡터의 기하학적 해석🐋

- 고유값은 변환의 스케일링 비율이고 고유 벡터는 변환의 주요 방향을 나타낸다.
- 고유값이 양수이면 고유 벡터 방향으로 벡터가 확대되는 것이고 음수면 벡터가 축소되는 것이다. 0이면 벡터가 유지된 것이다.
- 고유 벡터는 변환해도 방향이 유지된다. 즉 고유 벡터가 해당 변환의 "주축"이다. 
  - *고유벡터들은 서로 직교*하므로 선형 변환으로 공간이 어떻게 변했는지 이해하는데 도움이 된다.


🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁🍁


10/2

5w1

## 고유값과 고유 벡터 효과

공간에서 기저는 중요하다. 

### 	🐋기저🐋

​	기저는 벡터 공간을 생성하는데 필요한 최소한의 벡터 집합이다. 

​	어떤 벡터 공간에서 기저는 그 공간 내 모든 벡터를 선형 조합으로 나타낼 수 있는 벡터들의 집합이다. 

​	즉 *기저 벡터들은 선형 독립이고 공간 내 모든 벡터를 생성*할 수 있다.

### 	🐋직교🐋

​	벡터가 직교하면 두 벡터가 수직으로 놓여 있다. 즉 두 벡터의 내적이 0인 경우 벡터들은 직교한다.

​	직교 벡터들은 서로 수직으로 놓여 있기 때문에 독립적인 관계에 있다.



- 직교와 독립의 관계?

  - 직교면 무조건 독립이다. + 벡터의 개수와 공간의 차원 같아야 함.
  - 그러나 독립이라고 직교는 아니다.

  > 직교하는 N개의 벡터는 N차원 공간에서 기저가 될 수 있다

- 정부호행렬에서 고유값과 양의 정부호 행렬의 관계?

  - 양의 정부호행렬에서 고유값은 양수이다.
  - ?고유값이 양이면 양의 정부호행렬이다?



## 고유분해의 특성방정식

​	행렬의 고유값과 고유벡터를 구하는 과정에서 사용. 주어진 정방행렬 A에 대한 고유분해를 수행하려면 먼저 A의 고유값 찾아야 한다.

	> 특성방정식 : det(A - λI) = 0

​	특성방정식을 푸는 과정에서 람다에 대한 고유값들을 구할 수 있다. 

​	I는 단위행렬이다!!!! 대각선으로 람다 마이너스

  - 여기서 A의 역행렬이 존재하지 않아야 한다.
    - *역행렬이 존재하면 행렬 A가 정방행렬이면서 행렬식이 0이 아니라는 의미이다.*
    -  `det(A) ≠ 0 이어야 역행렬이 존재`

​	고유값을 찾으면 각 고유값에 대응하는 고유벡터를 찾을 수 있다. 

> (A - λI)v = 0

​	다음 선형 연립방정식을 풀면 고유벡터를 찾을 수 있다.



## 행렬 고유 분해

### 1. A가 정방행렬이다.

> A = QAQ^-1

Q는 A의 고유 벡터를 열에 배치한 행렬이고 A는 고유값을 대각선에 배치한 대각행렬이다.

### 1-2. A가 정방행렬이고 대칭행렬이다.

### 	🍁Q^-1 = Q^t?🍁

​	대칭행렬의 고유벡터 행렬이 *정규직교 행렬*이기 때문이다.

​	정규직교 행렬은 역행렬이 자신의 전치와 같다.

- 대칭행렬은 전치가 자기 자신과 같은 행렬로 정방행렬이다.


  -  고유벡터는 서로 직교한다.

     ```
     스펠트럴 정리 Spectral Theorem

     스펠트럴 정리는 대칭행렬에 대한 고유값과 고유벡터의 특성을 설명하는 정리다.
     1. 대칭행렬의 고유값은 실수이다.
     2. 대칭행렬의 서로 다른 고유값에 대응하는 고유벡터들은 서로 직교한다.
     3. 대칭행렬은 항상 대각화 가능하며 고유벡터들을 이용해 대각행렬로 표현할 수 있다.

     대각화 가능한 행렬
     	- 어떤 정방행렬 A가 대각화 가능하다는 것은, 행렬 A를 PDP^(-1)의 형태로 분해할 수 있는 경우이다.
     	- P는 고유벡터들을 열로 가진 행렬이고 역행렬이 존재해야 한다.
     	- D는 고유값들을 대각선에 배열한 대각행렬이다.
     	
     	대각화 가능의 조건
     		- 고유값들이 선형 독립이다.
     		- 고유벡터들이 선형 독립이다.
     ```

     🍁결론🍁

     `A가 대칭행렬이면 고유값은 실수이고 고유벡터는 서로 직교한다.`



## 행렬 특잇값 분해 SVD

### 2. A가 정방행렬이 아니다.

> A = UΣV^t

A는 n * m

- U는 AA^t의 고유벡터를 열에 배치하면 정방행렬 n * n
- V는 A^tA의 고유벡터를 열에 배치한 정방행렬 m * m
- Σ는 AA^t의 고유값의 제곱근을 대각선에 배치한 n * m 대각행렬 D로 표기하기도 함



## 행렬 분해의 기하학적 해석

A = UDV^t

1. V^t는 회젼 변환.
2. D는 크기 변환.
3. U는 회전 변환이다.

- 분해는 행렬의 역행렬을 구할 때 활용한다.



그 밖에 또 언제 고유벡터, 고유값을 사용하는가

위에서도 나왔는데 PCA. 고차원을 저차원으로 축소하거나, 축을 기점으로 투영할 때

1. A = XX^T, 분산행렬을 구한다.

2. A의 고유값 고유벡터를 구한다.

   고유값이 큰 순서대로 sorting한다. 고유값이 큰 주성분은 데이터의 주요 정보를 가장 많이 포함한다.

   선택한 주성분 고유벡터를 사용해 원래 데이터를 저차원으로 투영한다.